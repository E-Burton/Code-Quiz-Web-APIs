<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- Linking personal CSS stylesheet -->
    <link rel="stylesheet" href="./styles.css">

    <title>Coding Quiz</title>
  </head>
  <body>

    <!-- Main body for Highscores content -->
    <section class="col-md-8">
        <section class="row scores-align">
            <h1 style="padding-top: 25px; padding-bottom: 15px; text-decoration: underline;">Highscores</h1>
            <div id="display-highscores">Click 'Back to Start' to take the Coding Quiz and add a Highscore!</div>
            <div>
                <a href="../index.html"><button id="home-page" type="button" class="btn btn-success">Back to Start</button></a>
                <button id="clear-highscores" type="button" class="btn btn-danger">Clear Highscores</button>
            </div>
        </section>
    </section>

    <!-- Linking Boostrap JavaScript -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <script>
        // VARIABLE DECLARATIONS
        var highscoresDiv = document.getElementById("display-highscores");
        var savedScores = JSON.parse(localStorage.getItem("allEntries"));
        var clearHighscores = document.getElementById("clear-highscores");
        var sortedScores = savedScores;

        // Sorting highscores from highest to lowest
        sortedScores.sort(function(a, b) {
            return b.Score - a.Score;
          })

        // Creating event listener to clear local storage when button is clicked
        clearHighscores.addEventListener("click", function () {
          localStorage.clear();
          highscoresDiv.textContent = "Click 'Back to Start' to add a Highscore!";
        })

        // Removing default text in highscoresDiv if there are highscores saved in loacl storage
        if (savedScores.length > 0) {
          highscoresDiv.textContent = "";
        } 
        
        // Creating table row & table data for each item/object in savedScores array, displaying user initials and corresponding high score, and appending to the HTML document
        for (var i = 0; i < savedScores.length; i++) {
          var tableRow = document.createElement("tr");
          var tableData = document.createElement("td");
          tableData.textContent = i + 1 + " - " + savedScores[i].User + " " + savedScores[i].Score + "pts";
          tableRow.appendChild(tableData);
          highscoresDiv.appendChild(tableRow);
        }
    </script>

  </body>
</html>